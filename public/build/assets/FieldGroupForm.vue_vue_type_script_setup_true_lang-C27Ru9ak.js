import{d as H,r as L,C as J,p as W,c as p,b as d,g,a as l,u as e,w as s,i as n,F,f as G,t as f,j as C,m as i,z as X,A as Y}from"./app-Cx9OcbbQ.js";import{_ as $}from"./index-CUEd5gyv.js";import{_ as z}from"./Input.vue_vue_type_script_setup_true_lang-96XDn3cq.js";import{_ as y}from"./Label.vue_vue_type_script_setup_true_lang-rUqhGQbs.js";import{_ as Q}from"./Textarea.vue_vue_type_script_setup_true_lang-Diw8zQG9.js";import{C as D,_ as S,a as T,b as A,c as q,d as V}from"./SelectValue.vue_vue_type_script_setup_true_lang-DRW6NnfB.js";import{_ as R}from"./Switch.vue_vue_type_script_setup_true_lang-CgH_5wVa.js";import{P as K}from"./plus-DR9ecnbK.js";import{C as O,G as Z}from"./grip-vertical-ByaeJz50.js";import{T as M}from"./trash-2-BroFkXWK.js";import{C as ee}from"./circle-alert-E6781M6U.js";const te={class:"space-y-4"},le={class:"flex items-center justify-between"},se={key:0,class:"text-center text-muted-foreground text-sm py-4 border-2 border-dashed rounded"},oe={class:"flex items-center justify-between"},ae={class:"flex items-center gap-2 flex-1"},de={class:"text-sm font-medium"},ie={key:0,class:"text-xs text-muted-foreground"},re={key:1,class:"text-[10px] px-1.5 py-0.5 rounded bg-muted"},ne={class:"flex items-center gap-1"},ue={key:0,class:"grid gap-3 md:grid-cols-2"},pe={class:"space-y-1.5"},ce={class:"space-y-1.5"},me={class:"space-y-1.5 md:col-span-2"},fe={class:"space-y-1.5 md:col-span-2"},ye={class:"flex items-center space-x-2"},_e={key:0,class:"md:col-span-2 mt-2 pl-4 border-l-2"},ve=H({__name:"SubFieldEditor",props:{modelValue:{default:()=>[]},fieldTypes:{},allowComplexTypes:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(h,{emit:_}){const w=h,r=_,b=L(w.modelValue||[]),x=L({});J(()=>w.modelValue,k=>{b.value=k||[]},{deep:!0});const N=k=>{x.value[k]=!x.value[k]},E=()=>{b.value.push({name:"",label:"",type:"text",required:!1,instructions:"",field_config:{}}),r("update:modelValue",b.value)},B=k=>{b.value.splice(k,1),r("update:modelValue",b.value)},j=k=>{k.name=k.label.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_|_$/g,""),r("update:modelValue",b.value)},U=()=>{r("update:modelValue",b.value)},P=w.allowComplexTypes?w.fieldTypes:w.fieldTypes.filter(k=>!["repeater","group","flexible_content"].includes(k.type));return(k,v)=>{const I=W("SubFieldEditor",!0);return i(),p("div",te,[d("div",le,[l(e(y),{class:"text-sm font-medium"},{default:s(()=>[...v[0]||(v[0]=[n("Sub Fields",-1)])]),_:1}),l(e($),{type:"button",variant:"outline",size:"sm",onClick:E},{default:s(()=>[l(e(K),{class:"h-3 w-3 mr-1"}),v[1]||(v[1]=n(" Add Sub Field ",-1))]),_:1})]),b.value.length===0?(i(),p("div",se,' No sub fields. Click "Add Sub Field" to get started. ')):g("",!0),(i(!0),p(F,null,G(b.value,(m,a)=>(i(),p("div",{key:a,class:"border rounded-lg p-3 space-y-3 bg-muted/30"},[d("div",oe,[d("div",ae,[d("span",de,"Sub Field "+f(a+1),1),m.label?(i(),p("span",ie,"- "+f(m.label),1)):g("",!0),m.type?(i(),p("span",re,f(m.type),1)):g("",!0)]),d("div",ne,[l(e($),{type:"button",variant:"ghost",size:"sm",onClick:t=>N(a)},{default:s(()=>[x.value[a]?(i(),C(e(D),{key:0,class:"h-3 w-3"})):(i(),C(e(O),{key:1,class:"h-3 w-3"}))]),_:2},1032,["onClick"]),l(e($),{type:"button",variant:"ghost",size:"sm",onClick:t=>B(a)},{default:s(()=>[l(e(M),{class:"h-3 w-3 text-destructive"})]),_:1},8,["onClick"])])]),x.value[a]?g("",!0):(i(),p("div",ue,[d("div",pe,[l(e(y),{for:`subfield-label-${a}`,class:"text-xs"},{default:s(()=>[...v[2]||(v[2]=[n("Label",-1)])]),_:1},8,["for"]),l(e(z),{id:`subfield-label-${a}`,modelValue:m.label,"onUpdate:modelValue":t=>m.label=t,onBlur:t=>j(m),onInput:U,placeholder:"Field label",class:"h-8 text-sm"},null,8,["id","modelValue","onUpdate:modelValue","onBlur"])]),d("div",ce,[l(e(y),{for:`subfield-type-${a}`,class:"text-xs"},{default:s(()=>[...v[3]||(v[3]=[n("Type",-1)])]),_:1},8,["for"]),l(e(S),{modelValue:m.type,"onUpdate:modelValue":[t=>m.type=t,U]},{default:s(()=>[l(e(T),{class:"h-8 text-sm"},{default:s(()=>[l(e(A))]),_:1}),l(e(q),null,{default:s(()=>[(i(!0),p(F,null,G(e(P),t=>(i(),C(e(V),{key:t.type,value:t.type},{default:s(()=>[n(f(t.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),d("div",me,[l(e(y),{for:`subfield-name-${a}`,class:"text-xs"},{default:s(()=>[...v[4]||(v[4]=[n("Name",-1)])]),_:1},8,["for"]),l(e(z),{id:`subfield-name-${a}`,modelValue:m.name,"onUpdate:modelValue":t=>m.name=t,placeholder:"field_name",readonly:"",class:"h-8 text-sm bg-muted"},null,8,["id","modelValue","onUpdate:modelValue"])]),d("div",fe,[l(e(y),{for:`subfield-instructions-${a}`,class:"text-xs"},{default:s(()=>[...v[5]||(v[5]=[n("Instructions",-1)])]),_:1},8,["for"]),l(e(Q),{id:`subfield-instructions-${a}`,modelValue:m.instructions,"onUpdate:modelValue":t=>m.instructions=t,onInput:U,placeholder:"Instructions for this field",rows:"2",class:"text-sm"},null,8,["id","modelValue","onUpdate:modelValue"])]),d("div",ye,[l(e(R),{id:`subfield-required-${a}`,checked:m.required,"onUpdate:checked":t=>{m.required=t,U()}},null,8,["id","checked","onUpdate:checked"]),l(e(y),{for:`subfield-required-${a}`,class:"text-xs"},{default:s(()=>[...v[6]||(v[6]=[n("Required",-1)])]),_:1},8,["for"])]),(m.type==="repeater"||m.type==="group")&&h.allowComplexTypes?(i(),p("div",_e,[l(I,{modelValue:m.field_config.subfields,"onUpdate:modelValue":[t=>m.field_config.subfields=t,U],"field-types":h.fieldTypes,"allow-complex-types":!1},null,8,["modelValue","onUpdate:modelValue","field-types"])])):g("",!0)]))]))),128))])}}}),ge={key:0,class:"rounded-lg border border-destructive bg-destructive/10 p-4"},be={class:"flex items-start gap-3"},ke={class:"flex-1"},Ve={class:"list-disc list-inside space-y-1 text-sm text-destructive/90"},$e={class:"grid gap-6 md:grid-cols-3"},he={class:"md:col-span-2 space-y-6"},xe={class:"rounded-lg border p-6 space-y-4"},Fe={class:"space-y-2"},Ce={key:0,class:"text-sm text-destructive"},we={class:"space-y-2"},Ue={key:0,class:"text-sm text-destructive"},Ge={class:"rounded-lg border p-6 space-y-4"},Se={class:"flex items-center justify-between"},Te={key:0,class:"text-center text-muted-foreground py-8"},Ae={class:"flex items-start justify-between"},qe={class:"flex items-center gap-2 flex-1"},ze={class:"font-medium"},Le={key:0,class:"text-sm text-muted-foreground"},Ne={key:1,class:"text-xs px-2 py-0.5 rounded bg-muted"},Ee={class:"flex items-center gap-1"},Be={key:0,class:"grid gap-4 md:grid-cols-2"},je={class:"space-y-2"},Pe={class:"space-y-2"},Ie={class:"space-y-2 md:col-span-2"},De={class:"space-y-2 md:col-span-2"},Re={class:"flex items-center space-x-2"},Ke={key:0,class:"md:col-span-2 mt-4 pt-4 border-t"},Oe={class:"rounded-lg border p-6 space-y-4"},Me={class:"flex items-center justify-between"},He={key:0,class:"text-center text-muted-foreground py-8"},Je={class:"flex items-start justify-between"},Qe={class:"flex items-center gap-2 flex-1"},We={class:"font-medium"},Xe={key:0,class:"text-xs px-2 py-0.5 rounded bg-muted"},Ye={class:"flex items-center gap-1"},Ze={key:0,class:"grid gap-4 md:grid-cols-2"},et={class:"space-y-2"},tt={class:"space-y-2"},lt={class:"space-y-6"},st={class:"rounded-lg border p-6 space-y-4"},ot={class:"space-y-2"},at={class:"space-y-2"},dt={class:"flex items-center space-x-2"},gt=H({__name:"FieldGroupForm",props:{fieldGroup:{},fieldTypes:{},pages:{},posts:{},postTypes:{},categories:{}},setup(h){const _=h,w=a=>a.map(t=>{const o=Array.isArray(t.field_config)?{}:t.field_config||{};return(t.type==="repeater"||t.type==="group")&&!o.subfields&&(o.subfields=[]),{...t,field_config:o,conditional_logic:Array.isArray(t.conditional_logic)&&t.conditional_logic.length===0?{}:t.conditional_logic||{}}}),r=X({title:_.fieldGroup?.title||"",key:_.fieldGroup?.key||"",position:_.fieldGroup?.position||"normal",style:_.fieldGroup?.style||"default",active:_.fieldGroup?.active??!0,fields:_.fieldGroup?.fields?w(_.fieldGroup.fields):[],locations:_.fieldGroup?.locations||[]}),b=L({}),x=L({}),N=a=>{b.value[a]=!b.value[a]},E=a=>{x.value[a]=!x.value[a]};J(()=>r.title,a=>{_.fieldGroup||(r.key=a.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_|_$/g,""))});const B=()=>{r.fields.push({key:"",label:"",name:"",type:"text",instructions:"",required:!1,conditional_logic:{},field_config:{},order:r.fields.length})},j=a=>{r.fields.splice(a,1),r.fields.forEach((t,o)=>{t.order=o})},U=a=>{a.name=a.label.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_|_$/g,""),a.key=`field_${Date.now()}_${a.name}`},P=a=>{Array.isArray(a.field_config)&&(a.field_config={}),(a.type==="repeater"||a.type==="group")&&!a.field_config.subfields&&(a.field_config.subfields=[])},k=()=>{r.locations.push({entity_type:"page",entity_id:null,rules:{}})},v=a=>{r.locations.splice(a,1)},I=()=>{console.log("[FieldGroupForm] Submitting form data:",r.data()),console.log("[FieldGroupForm] Form errors before submit:",r.errors),_.fieldGroup?r.put(`/cms/field-groups/${_.fieldGroup.id}`,{onSuccess:()=>{console.log("[FieldGroupForm] Update successful")},onError:a=>{console.error("[FieldGroupForm] Update failed with errors:",a)}}):r.post("/cms/field-groups",{onSuccess:()=>{console.log("[FieldGroupForm] Create successful")},onError:a=>{console.error("[FieldGroupForm] Create failed with errors:",a)}})},m=a=>{switch(a){case"page":return _.pages.map(t=>({id:t.id,label:t.title}));case"post":return _.posts.map(t=>({id:t.id,label:t.title}));case"post_type":return _.postTypes.map(t=>({id:t.id,label:t.title}));case"category":return _.categories.map(t=>({id:t.id,label:t.name}));default:return[]}};return(a,t)=>(i(),p("form",{onSubmit:Y(I,["prevent"]),class:"space-y-8"},[Object.keys(e(r).errors).length>0?(i(),p("div",ge,[d("div",be,[l(e(ee),{class:"h-5 w-5 text-destructive flex-shrink-0 mt-0.5"}),d("div",ke,[t[5]||(t[5]=d("h3",{class:"font-semibold text-destructive mb-2"},"Validation Errors",-1)),d("ul",Ve,[(i(!0),p(F,null,G(e(r).errors,(o,c)=>(i(),p("li",{key:c},[d("strong",null,f(c)+":",1),n(" "+f(o),1)]))),128))])])])])):g("",!0),d("div",$e,[d("div",he,[d("div",xe,[t[8]||(t[8]=d("h3",{class:"font-semibold"},"Field Group Settings",-1)),d("div",Fe,[l(e(y),{for:"title"},{default:s(()=>[...t[6]||(t[6]=[n("Title",-1)])]),_:1}),l(e(z),{id:"title",modelValue:e(r).title,"onUpdate:modelValue":t[0]||(t[0]=o=>e(r).title=o),placeholder:"Field group title",required:""},null,8,["modelValue"]),e(r).errors.title?(i(),p("p",Ce,f(e(r).errors.title),1)):g("",!0)]),d("div",we,[l(e(y),{for:"key"},{default:s(()=>[...t[7]||(t[7]=[n("Key",-1)])]),_:1}),l(e(z),{id:"key",modelValue:e(r).key,"onUpdate:modelValue":t[1]||(t[1]=o=>e(r).key=o),placeholder:"field_group_key",required:""},null,8,["modelValue"]),e(r).errors.key?(i(),p("p",Ue,f(e(r).errors.key),1)):g("",!0)])]),d("div",Ge,[d("div",Se,[t[10]||(t[10]=d("h3",{class:"font-semibold"},"Fields",-1)),l(e($),{type:"button",variant:"outline",size:"sm",onClick:B},{default:s(()=>[l(e(K),{class:"mr-2 h-4 w-4"}),t[9]||(t[9]=n(" Add Field ",-1))]),_:1})]),e(r).fields.length===0?(i(),p("div",Te,' No fields added yet. Click "Add Field" to get started. ')):g("",!0),(i(!0),p(F,null,G(e(r).fields,(o,c)=>(i(),p("div",{key:c,class:"border rounded-lg p-4 space-y-4"},[d("div",Ae,[d("div",qe,[l(e(Z),{class:"h-4 w-4 text-muted-foreground"}),d("span",ze,"Field "+f(c+1),1),o.label?(i(),p("span",Le,"- "+f(o.label),1)):g("",!0),o.type?(i(),p("span",Ne,f(o.type),1)):g("",!0)]),d("div",Ee,[l(e($),{type:"button",variant:"ghost",size:"icon",onClick:u=>N(c)},{default:s(()=>[b.value[c]?(i(),C(e(D),{key:0,class:"h-4 w-4"})):(i(),C(e(O),{key:1,class:"h-4 w-4"}))]),_:2},1032,["onClick"]),l(e($),{type:"button",variant:"ghost",size:"icon",onClick:u=>j(c)},{default:s(()=>[l(e(M),{class:"h-4 w-4 text-destructive"})]),_:1},8,["onClick"])])]),b.value[c]?g("",!0):(i(),p("div",Be,[d("div",je,[l(e(y),{for:`field-label-${c}`},{default:s(()=>[...t[11]||(t[11]=[n("Label",-1)])]),_:1},8,["for"]),l(e(z),{id:`field-label-${c}`,modelValue:o.label,"onUpdate:modelValue":u=>o.label=u,onBlur:u=>U(o),placeholder:"Field label"},null,8,["id","modelValue","onUpdate:modelValue","onBlur"])]),d("div",Pe,[l(e(y),{for:`field-type-${c}`},{default:s(()=>[...t[12]||(t[12]=[n("Type",-1)])]),_:1},8,["for"]),l(e(S),{modelValue:o.type,"onUpdate:modelValue":[u=>o.type=u,u=>P(o)]},{default:s(()=>[l(e(T),null,{default:s(()=>[l(e(A))]),_:1}),l(e(q),null,{default:s(()=>[(i(!0),p(F,null,G(h.fieldTypes,u=>(i(),C(e(V),{key:u.type,value:u.type},{default:s(()=>[n(f(u.label),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),d("div",Ie,[l(e(y),{for:`field-name-${c}`},{default:s(()=>[...t[13]||(t[13]=[n("Name",-1)])]),_:1},8,["for"]),l(e(z),{id:`field-name-${c}`,modelValue:o.name,"onUpdate:modelValue":u=>o.name=u,placeholder:"field_name",readonly:""},null,8,["id","modelValue","onUpdate:modelValue"])]),d("div",De,[l(e(y),{for:`field-instructions-${c}`},{default:s(()=>[...t[14]||(t[14]=[n("Instructions",-1)])]),_:1},8,["for"]),l(e(Q),{id:`field-instructions-${c}`,modelValue:o.instructions,"onUpdate:modelValue":u=>o.instructions=u,placeholder:"Instructions for this field"},null,8,["id","modelValue","onUpdate:modelValue"])]),d("div",Re,[l(e(R),{id:`field-required-${c}`,checked:o.required,"onUpdate:checked":u=>o.required=u},null,8,["id","checked","onUpdate:checked"]),l(e(y),{for:`field-required-${c}`},{default:s(()=>[...t[15]||(t[15]=[n("Required",-1)])]),_:1},8,["for"])]),o.type==="repeater"||o.type==="group"?(i(),p("div",Ke,[l(ve,{modelValue:o.field_config.subfields,"onUpdate:modelValue":u=>o.field_config.subfields=u,"field-types":h.fieldTypes,"allow-complex-types":!0},null,8,["modelValue","onUpdate:modelValue","field-types"])])):g("",!0)]))]))),128))]),d("div",Oe,[d("div",Me,[t[17]||(t[17]=d("h3",{class:"font-semibold"},"Location Rules",-1)),l(e($),{type:"button",variant:"outline",size:"sm",onClick:k},{default:s(()=>[l(e(K),{class:"mr-2 h-4 w-4"}),t[16]||(t[16]=n(" Add Location ",-1))]),_:1})]),e(r).locations.length===0?(i(),p("div",He," No location rules added. This field group won't appear anywhere. ")):g("",!0),(i(!0),p(F,null,G(e(r).locations,(o,c)=>(i(),p("div",{key:c,class:"border rounded-lg p-4 space-y-4"},[d("div",Je,[d("div",Qe,[d("span",We,"Location "+f(c+1),1),o.entity_type?(i(),p("span",Xe,f(o.entity_type),1)):g("",!0)]),d("div",Ye,[l(e($),{type:"button",variant:"ghost",size:"icon",onClick:u=>E(c)},{default:s(()=>[x.value[c]?(i(),C(e(D),{key:0,class:"h-4 w-4"})):(i(),C(e(O),{key:1,class:"h-4 w-4"}))]),_:2},1032,["onClick"]),l(e($),{type:"button",variant:"ghost",size:"icon",onClick:u=>v(c)},{default:s(()=>[l(e(M),{class:"h-4 w-4 text-destructive"})]),_:1},8,["onClick"])])]),x.value[c]?g("",!0):(i(),p("div",Ze,[d("div",et,[l(e(y),{for:`location-type-${c}`},{default:s(()=>[...t[18]||(t[18]=[n("Entity Type",-1)])]),_:1},8,["for"]),l(e(S),{modelValue:o.entity_type,"onUpdate:modelValue":[u=>o.entity_type=u,u=>o.entity_id=null]},{default:s(()=>[l(e(T),null,{default:s(()=>[l(e(A))]),_:1}),l(e(q),null,{default:s(()=>[l(e(V),{value:"page"},{default:s(()=>[...t[19]||(t[19]=[n("Page",-1)])]),_:1}),l(e(V),{value:"post"},{default:s(()=>[...t[20]||(t[20]=[n("Post",-1)])]),_:1}),l(e(V),{value:"post_type"},{default:s(()=>[...t[21]||(t[21]=[n("Post Type",-1)])]),_:1}),l(e(V),{value:"category"},{default:s(()=>[...t[22]||(t[22]=[n("Category",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),d("div",tt,[l(e(y),{for:`location-entity-${c}`},{default:s(()=>[n("Specific "+f(o.entity_type==="post_type"?"Post Type":o.entity_type.charAt(0).toUpperCase()+o.entity_type.slice(1))+" (Optional)",1)]),_:2},1032,["for"]),l(e(S),{"model-value":o.entity_id!==null?String(o.entity_id):"all","onUpdate:modelValue":u=>o.entity_id=u==="all"?null:Number(u)},{default:s(()=>[l(e(T),null,{default:s(()=>[l(e(A),{placeholder:`All ${o.entity_type}s`},null,8,["placeholder"])]),_:2},1024),l(e(q),null,{default:s(()=>[l(e(V),{value:"all"},{default:s(()=>[n("All "+f(o.entity_type)+"s",1)]),_:2},1024),(i(!0),p(F,null,G(m(o.entity_type),u=>(i(),C(e(V),{key:u.id,value:String(u.id)},{default:s(()=>[n(f(u.label),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["model-value","onUpdate:modelValue"])])]))]))),128))])]),d("div",lt,[d("div",st,[t[30]||(t[30]=d("h3",{class:"font-semibold"},"Settings",-1)),d("div",ot,[l(e(y),{for:"position"},{default:s(()=>[...t[23]||(t[23]=[n("Position",-1)])]),_:1}),l(e(S),{modelValue:e(r).position,"onUpdate:modelValue":t[2]||(t[2]=o=>e(r).position=o)},{default:s(()=>[l(e(T),null,{default:s(()=>[l(e(A))]),_:1}),l(e(q),null,{default:s(()=>[l(e(V),{value:"normal"},{default:s(()=>[...t[24]||(t[24]=[n("Normal",-1)])]),_:1}),l(e(V),{value:"side"},{default:s(()=>[...t[25]||(t[25]=[n("Side",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),d("div",at,[l(e(y),{for:"style"},{default:s(()=>[...t[26]||(t[26]=[n("Style",-1)])]),_:1}),l(e(S),{modelValue:e(r).style,"onUpdate:modelValue":t[3]||(t[3]=o=>e(r).style=o)},{default:s(()=>[l(e(T),null,{default:s(()=>[l(e(A))]),_:1}),l(e(q),null,{default:s(()=>[l(e(V),{value:"default"},{default:s(()=>[...t[27]||(t[27]=[n("Default",-1)])]),_:1}),l(e(V),{value:"seamless"},{default:s(()=>[...t[28]||(t[28]=[n("Seamless",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),d("div",dt,[l(e(R),{id:"active",checked:e(r).active,"onUpdate:checked":t[4]||(t[4]=o=>e(r).active=o)},null,8,["checked"]),l(e(y),{for:"active"},{default:s(()=>[...t[29]||(t[29]=[n("Active",-1)])]),_:1})])]),l(e($),{type:"submit",class:"w-full",disabled:e(r).processing},{default:s(()=>[e(r).processing?(i(),p(F,{key:0},[n(f(h.fieldGroup?"Updating...":"Creating..."),1)],64)):(i(),p(F,{key:1},[n(f(h.fieldGroup?"Update":"Create")+" Field Group ",1)],64))]),_:1},8,["disabled"])])])],32))}});export{gt as _};
